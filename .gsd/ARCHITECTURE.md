# Architecture

> Auto-generated by /map on 2026-02-17

## Overview

Film Scrubber is a client-side Next.js application designed to analyze YouTube videos with frame-by-frame scrubbing and slow-motion capabilities. It leverages the YouTube IFrame Player API to control playback and provides a custom UI for precise navigation.

```
┌─────────────────────────────────────────┐
│              [Page Entry]               │
│         (src/app/page.tsx)              │
├─────────────────────────────────────────┤
│            [ScrubberShell]              │
│      (Main Container & State Mgr)       │
├─────────────────────────────────────────┤
│  [UrlInput]  [PlayerArea]  [ControlBar] │
└─────────────────────────────────────────┘
```

## Components

### ScrubberShell
- **Purpose:** Main container that orchestrates application state (video ID, speed, playback status). Manages synchronization between URL parameters, local storage settings, and the player.
- **Location:** `src/components/ScrubberShell.tsx`
- **Dependencies:** `useYouTubePlayer`, `useScrubberControls`, `useKeyboardShortcuts`, `lib/urlState`, `lib/settings`.

### PlayerArea
- **Purpose:** Wraps the YouTube IFrame player. Handles the visual presentation of the video.
- **Location:** `src/components/PlayerArea.tsx`
- **Dependencies:** `react-youtube` (via hook/ref).

### ControlBar
- **Purpose:** Provides UI controls for playback (play/pause), scrubbing (stepping frames), speed control, and slow-motion toggles.
- **Location:** `src/components/ControlBar.tsx`
- **Dependencies:** `useScrubberControls`.

### UrlInput
- **Purpose:** Accepts and validates YouTube URLs.
- **Location:** `src/components/UrlInput.tsx`

### HelpPanel
- **Purpose:** Displays keyboard shortcuts and usage instructions.
- **Location:** `src/components/HelpPanel.tsx`

## Data Flow

1.  **Initialization:** `ScrubberShell` loads settings from `localStorage` and settings applied URL query parameters (`videoId`, `seekTime`, `speed`).
2.  **Input:** User provides a YouTube URL via `UrlInput`.
3.  **Loading:** `extractVideoId` validates the URL. If valid, `videoId` state is updated.
4.  **Playback:** `useYouTubePlayer` initializes the external YouTube player.
5.  **Interaction:** User clicks controls in `ControlBar` or uses keyboard shortcuts. Actions are handled by `useScrubberControls` which interacts with the player instance.
6.  **Persistence:** State changes trigger updates to URL (via `replaceState`) and `localStorage` (for preferences like speed).

## Integration Points

| Service | Type | Purpose |
|---------|------|---------|
| YouTube Data API | IFrame | Video playback and control interface (via `window.YT`). |

## Technical Debt

- [ ] `ScrubberShell` complexity: Extensive state management and effect hooks could be refactored into a custom hook or reducer.
- [ ] Error Handling: No explicit error boundary for YouTube player failures.

## Conventions

**Naming:** PascalCase for components, camelCase for hooks/functions.
**Structure:**
- `src/app`: Page routes
- `src/components`: UI Components
- `src/hooks`: Custom React hooks
- `src/lib`: Logic & Utilities
**State:** URL (shareable), LocalStorage (preferences), React State (ephemeral).
