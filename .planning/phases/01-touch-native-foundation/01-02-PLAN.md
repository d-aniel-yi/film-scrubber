---
phase: 01-touch-native-foundation
plan: 02
type: execute
wave: 2
depends_on:
  - "01-01"
files_modified:
  - src/components/ControlBar.tsx
  - src/hooks/useScrubberControls.ts
  - src/components/ScrubberShell.tsx
autonomous: true

must_haves:
  truths:
    - "User sees visual press feedback when tapping any button"
    - "User sees distinct visual state on hold buttons while actively holding them"
    - "Hold buttons return to normal state when user releases"
  artifacts:
    - path: "src/components/ControlBar.tsx"
      provides: "Active state styling for all buttons"
      contains: "active:bg-"
    - path: "src/hooks/useScrubberControls.ts"
      provides: "Hold state tracking"
      exports: ["isHolding"]
    - path: "src/components/ScrubberShell.tsx"
      provides: "Hold state passed to ControlBar"
      contains: "isHolding"
  key_links:
    - from: "Hold buttons"
      to: "scrubber.isHolding state"
      via: "conditional className"
      pattern: "isHolding.*bg-|bg-.*isHolding"
---

<objective>
Add visual press feedback to all buttons and distinct "being held" state to hold buttons.

Purpose: Complete touch-native foundation by providing immediate visual feedback that confirms user interactions, making buttons feel responsive like native app controls.
Output: All buttons show active press state, hold buttons show distinct visual state while being held.
</objective>

<execution_context>
@C:\Users\Daniel\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Daniel\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@h:/film/.planning/PROJECT.md
@h:/film/.planning/ROADMAP.md
@h:/film/.planning/REQUIREMENTS.md
@h:/film/.planning/phases/01-touch-native-foundation/01-01-SUMMARY.md
@h:/film/src/components/ControlBar.tsx
@h:/film/src/hooks/useScrubberControls.ts
@h:/film/src/components/ScrubberShell.tsx
</context>

<tasks>

<task type="auto">
  <name>Add active press feedback to all buttons</name>
  <files>src/components/ControlBar.tsx</files>
  <action>
Add `active:` pseudo-class styles to all button className attributes for instant visual press feedback.

Buttons to update:

1. **Play/pause button** (line ~105): Add `active:scale-95 active:bg-zinc-900 dark:active:bg-zinc-100` to className
   - Scale down slightly + darken background on press

2. **Step buttons** (lines ~150, ~158): Add `active:scale-95 active:bg-zinc-200 dark:active:bg-zinc-600` to className
   - Scale down + darken background on press

3. **Jump buttons** (lines ~169, ~177): Add `active:scale-95 active:bg-zinc-200 dark:active:bg-zinc-600` to className
   - Scale down + darken background on press

4. **Hold buttons** (lines ~192, ~204): Already have `active:scale-95 active:bg-zinc-200 dark:active:bg-zinc-600` - no changes needed

Do NOT add active states to:
- Select elements (use native browser styling)
- Input elements (seek bar, number input)
- Non-interactive elements (spans, text)

Pattern: Use `active:scale-95` for subtle scale-down + color shift to darker shade of existing background.

Why active over focus: `active:` triggers on pointer down (immediate feedback), while `focus:` persists after tap (not desired for press feedback).
  </action>
  <verify>
npm run build
# Should compile successfully
  </verify>
  <done>
All button elements have `active:scale-95` and `active:bg-*` classes for press feedback. Build passes.
  </done>
</task>

<task type="auto">
  <name>Add hold state tracking and visual indicator</name>
  <files>
src/hooks/useScrubberControls.ts
src/components/ScrubberShell.tsx
src/components/ControlBar.tsx
  </files>
  <action>
Implement distinct visual state for hold buttons while being held (different from momentary press feedback).

**Step 1: Track hold state in useScrubberControls.ts**

Add `isHolding` state and return it from the hook:

```typescript
const [isHolding, setIsHolding] = useState(false);

const startHoldRewind = useCallback(() => {
  if (!controller?.ready) return;
  clearHold();
  setIsHolding(true);  // Add this
  wasPlayingRef.current = controller.isPlaying;
  controller.pause();
  holdIntervalRef.current = setInterval(() => {
    const t = controller.getCurrentTime();
    const next = Math.max(0, t - stepSize);
    controller.seekTo(next);
  }, holdTickRateMs);
}, [controller, stepSize, holdTickRateMs, clearHold]);

const startHoldForward = useCallback(() => {
  if (!controller?.ready) return;
  clearHold();
  setIsHolding(true);  // Add this
  wasPlayingRef.current = controller.isPlaying;
  controller.pause();
  holdIntervalRef.current = setInterval(() => {
    const t = controller.getCurrentTime();
    const next = t + stepSize;
    controller.seekTo(next);
  }, holdTickRateMs);
}, [controller, stepSize, holdTickRateMs, clearHold]);

const stopHold = useCallback(() => {
  clearHold();
  setIsHolding(false);  // Add this
  if (wasPlayingRef.current && controller?.ready) {
    controller.play();
  }
  wasPlayingRef.current = false;
}, [clearHold, controller]);
```

Update return type to include isHolding:

```typescript
return {
  stepBack: () => step(-1),
  stepForward: () => step(1),
  jumpBack: (seconds: number) => jump(-seconds),
  jumpForward: (seconds: number) => jump(seconds),
  startHoldRewind,
  startHoldForward,
  stopHold,
  isHolding,  // Add this
  stepSize,
  jumpAmounts: JUMP_AMOUNTS,
};
```

**Step 2: Pass isHolding through ScrubberShell.tsx**

No changes needed - scrubber object is already passed to ControlBar, so `scrubber.isHolding` will be available automatically.

**Step 3: Apply conditional className in ControlBar.tsx**

Update hold buttons (lines ~192, ~204) to show distinct visual state when held:

For Rewind button:
```typescript
className={`flex-1 select-none touch-manipulation rounded border bg-white py-3 text-center text-sm font-medium hover:bg-zinc-100 active:scale-95 active:bg-zinc-200 dark:bg-zinc-800 dark:hover:bg-zinc-700 dark:active:bg-zinc-600 sm:flex-none sm:px-3 sm:py-2.5 ${
  scrubber.isHolding
    ? 'border-zinc-500 bg-zinc-200 dark:border-zinc-400 dark:bg-zinc-600'
    : 'border-zinc-300 dark:border-zinc-600'
}`}
```

For Forward button (same pattern):
```typescript
className={`flex-1 select-none touch-manipulation rounded border bg-white py-3 text-center text-sm font-medium hover:bg-zinc-100 active:scale-95 active:bg-zinc-200 dark:bg-zinc-800 dark:hover:bg-zinc-700 dark:active:bg-zinc-600 sm:flex-none sm:px-3 sm:py-2.5 ${
  scrubber.isHolding
    ? 'border-zinc-500 bg-zinc-200 dark:border-zinc-400 dark:bg-zinc-600'
    : 'border-zinc-300 dark:border-zinc-600'
}`}
```

Pattern: When holding, apply thicker darker border + darker background (sustained state), distinct from momentary active: press feedback.

Update ScrubberControls type definition in ControlBar.tsx (line ~9):
```typescript
type ScrubberControls = {
  stepBack: () => void;
  stepForward: () => void;
  jumpBack: (seconds: number) => void;
  jumpForward: (seconds: number) => void;
  startHoldRewind: () => void;
  startHoldForward: () => void;
  stopHold: () => void;
  isHolding: boolean;  // Add this
  jumpAmounts: readonly number[];
};
```
  </action>
  <verify>
npm run build
# Should compile successfully
# Manual: Load video, press and hold Rewind or Forward button - background and border should darken while held, return to normal on release
  </verify>
  <done>
Hold state tracked in useScrubberControls with `isHolding` boolean. Hold buttons show distinct visual state (darker background + border) while being held. Build passes.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Visual press feedback for all buttons and distinct "being held" state for hold buttons.
  </what-built>
  <how-to-verify>
1. Load a video on the app
2. Test press feedback on each button type:
   - **Play/pause**: Tap and hold - should see scale-down + darker background
   - **Step buttons** (−/+): Tap and hold - should see scale-down + darker background
   - **Jump buttons** (±1s, ±5s, ±10s): Tap and hold - should see scale-down + darker background
   - **Hold buttons**: Quick tap - should see momentary scale-down + darker background
3. Test hold state on hold buttons:
   - Press and hold Rewind button - background and border should darken and STAY dark while held
   - Release - should return to normal state immediately
   - Press and hold Forward button - same distinct visual state while held
   - Release - should return to normal
4. Verify hold state is distinct from press feedback (sustained darker background vs momentary scale-down)
  </how-to-verify>
  <resume-signal>Type "approved" to continue or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
Run build to verify no TypeScript or compilation errors.
Manual verification that:
- All buttons show visual press feedback when tapped
- Hold buttons show distinct sustained visual state while being held
- Hold buttons return to normal state on release
</verification>

<success_criteria>
- All button elements have `active:scale-95` and `active:bg-*` classes
- useScrubberControls tracks `isHolding` state
- Hold buttons apply conditional className based on `isHolding`
- Build compiles successfully
- User sees immediate visual feedback on all button presses
- User sees distinct sustained visual state on hold buttons while holding
</success_criteria>

<output>
After completion, create `.planning/phases/01-touch-native-foundation/01-02-SUMMARY.md`
</output>
